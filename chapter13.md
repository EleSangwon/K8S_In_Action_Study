# 클러스터 노드와 네트워크를 위한 보안

## 포드 내에서 호스트 노드의 네임스페이스 사용하기
```
포드 내에 컨테이너에서 실행 중인 프로세스는 일반적으로 분리된 리눅스 네임스페이스 아래에서 실행되고
다른 컨테이너나 노드의 기본 네임스페이스에서 실행 중인 프로세스와는 분리된다.

예를 들어 각 포드는 자체 네트워크 네임스페이스를 사용하기 때문에 자체 IP 및 포트 공간을 얻는다는 것을 
알고 있다.
마찬가지로 각 포드에는 고유한 PID 네임스페이스가 있기 때문에 고유한 프로세스 트리가 존재하며 
고유한 IPC 네임스페이스도 유지되므로 동일한 포드의 프로세스 사이에만 
프로세스 간 통신 매커니즘(IPC)을 통해 서로 통신할 수 있다.
```

## 포드에서 노드의 네트워크 네임스페이스 사용하기
```
특정 포드는 호스트의 기본 네임스페이스에서 동작해야 노드 레벨 리소스와 장치를 
관찰하고 조작할 수 있다. 예를 들어 포드는 자체 가상 네트워크 어댑터 대신 포드가 속한
노드의 네트워크 어댑터 사용이 필요할 수 있다. 

아래 그림의 경우 포드는 자체 포드 네트워크 인터페이스를 갖는 대신 노드의 네트워크 인터페이스를 사용한다.
이 것은 포드가 자체 IP 주소를 갖지 않는 것을 의미하며, 포트에 바인드된 프로세스가 기동된다면,
그 프로세스는 포드 포트가 아니라 노드 포트에 바인드될 것이다.
```
![image](https://user-images.githubusercontent.com/50174803/138556150-ff50617b-097a-4745-8cc1-241fc651b8d7.png)

![image](https://user-images.githubusercontent.com/50174803/138556256-f3fe878b-9599-4fc6-ae06-4309e11a5d35.png)
![image](https://user-images.githubusercontent.com/50174803/138556263-48046730-0ab6-4b5e-be8c-21fc03724c1f.png)

## 호스트 네임스페이스를 사용하지 않고 호스트 포트에 바인딩하기 554
```
포드가 hostPort를 사용할 때 NodePort에 대한 연결이 해당 노드에서 실행 중인 포드로 
직접 전달되는 반면 NodePort 서비스에서는 NodePort에 대한 연결이 무작위로 선택된 포드로 전달된다.

또 다른 차이점은 hostPort를 사용하는 포드에서는 NodePort가 이런 포드를 실행하는 노드에만 바인딩되는 반면
NodePort 서비스는 포드를 실행하지 않는 모든 노드에서 조차도 포트를 바인딩한다는 것이다.(노드3과 마찬가지로)

포드가 특정 호스트 포트를 사용하는 경우, 두 개의 프로세스가 동일한 호스트 포트에 바인딩할 수 없으므로
포드 인스턴스 중 하나씩 각 노드에 스케줄할 수 있다는 것을 이해하는 것이 중요하다.

그림 13.3과 같이 동일한 노드에 여러 개의 포드를 스케줄하지 않는다. 
3개의 노드가 있고 4개의 포드 복제본을 배포하려는 경우 3개만 스케줄된다.
```
![image](https://user-images.githubusercontent.com/50174803/138556303-cff1113d-1e4f-461e-9d4f-0e51afb0e2fe.png)
![image](https://user-images.githubusercontent.com/50174803/138556576-7630204d-3f7c-4cb0-83ca-ccd19279db64.png)
